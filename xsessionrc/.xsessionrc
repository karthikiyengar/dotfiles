#!bin/bash
if [[ "$DESKTOP_SESSION" == *"xmonad"* ]] 
then
  source ~/.profile
  # enable compositing
  # compton --backend glx --xrender-sync --xrender-sync-fence -fCz --fade-delta 4 &!
  picom --fade-delta 3 -CfGb

  # Applets
  nm-applet &!
  pasystray &!
  blueman-applet &!
  greenclip daemon &!
  rumno-background &!
  
  # Set cursor to pointer
  xsetroot -cursor_name left_ptr &!
  
  # Load custom fonts
  xset +fp $HOME/.local/share/fonts
  xset fp rehash &!
  
  # Set the correct xrandr settings
  autorandr -c
  
  # Set Wallpaper
  if [ -f ~/.wallpapers/current-wallpaper.jpg ]; then
    feh --bg-scale ~/.wallpapers/current-wallpaper.jpg
  else
    feh --bg-scale ~/.wallpapers/dark-space.jpg
  fi
 
  if [ -x "$(command -v nextcloud)" ]; then
    nextcloud --background &!
  fi

  rumno-background &!
  
  # Set touchpad settings
  ~/.wm-scripts/touchpad-settings.sh  
  
  # Run xidlehook
  export RUST_LOG=trace  
  xidlehook --not-when-fullscreen --not-when-audio --timer 60 'xrandr --output "eDP-1" --brightness .3' 'xrandr --output "eDP-1" --brightness 1' --timer 10 'xrandr --output "eDP-1" --brightness 1; i3lock -i ~/.wallpapers/i3lock.png' '' --timer 1800 'systemctl hybrid-sleep' '' >> $HOME/.xidlehook.log 2>> $HOME/.xidlehook.err &
fi
